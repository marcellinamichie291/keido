+++
title = "ğŸ“Clojure Date/Time/Timestamp"
lastmod = 2022-08-16T12:27:57+09:00
tags = ["WIKI"]
draft = false
+++

-   up: [ğŸ“‚Clojure Core Languages]({{< relref "20220112142936.md" >}})
-   tags: [ğŸ·Date/Time/Timestamp]({{< relref "20220326063706.md" >}})
-   refs.
    -   [ğŸ“Java Date/Time/Timestamp]({{< relref "20220816064530.md" >}})


## Overview {#3b8782}

Clojureã«ãŠã‘ã‚‹æ™‚é–“ã®æ‰±ã„ã«ã¤ã„ã¦ã¾ã¨ã‚.

Clojureã¯Javaã®ä»•çµ„ã¿ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§[ğŸ“Java Date/Time/Timestamp]({{< relref "20220816064530.md" >}})ã®çŸ¥è­˜ãŒã‚ã‚‹ã¨ã‚ˆã„.

Clojureã¯ãŸã‚“ãªã‚‹ãƒ©ãƒƒãƒ‘ãƒ¼ãªã®ã§å›°ã£ãŸã¨ãã«ã‚‚Javaã¨ä¸€ç·’ã«æ¤œç´¢ã§æ¢ã™ã¨ã„ã„. æœ€æ‚ªJavaã‚’å‘¼ã³å‡ºã›ã°ãªã‚“ã¨ã‹ãªã‚‹.


### Java joda-time vs java.time {#123967}

Javaã®æ™‚é–“ã®APIãŒJava8ã‚’å ºã«ã‚ã‹ã‚Œã‚‹ã‚ˆã†ã«Clojureã‚‚java.timeã¨joda-timeã®ã©ã¡ã‚‰ã‚’ã¤ã‹ã†ã‹ã‚’æ°—ã«ã‹ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹.

;=> #object ã¨ãªã£ã¦ã„ãŸã‚‰java.time, ;=> #instã¨ãªã£ã¦ã„ãŸã‚‰Joda-Time.

ãªãŠclojureæ¨™æº–ã®clojure.instantã¯joda-time.


## clojure.instant {#7c82dcfb-2402-42d4-9868-1d5649da6a9a}

æ–‡å­—åˆ—ã‚’èª­ã¿å–ã‚‹é–¢æ•°ãŒã„ãã¤ã‹å®šç¾©ã•ã‚Œã¦ã„ã‚‹.

<https://clojuredocs.org/clojure.instant>

-   parse-timestamp: RFC3339-likeãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®parse.
-   read-instant-xxx

ã“ã‚Œã¯[Java: Joda-Time]({{< relref "20220816064530.md#5241d177-9efa-401e-9334-d0238370f149" >}})ã¨ãªã‚‹.


## clj-time {#804f0a}

<https://github.com/clj-time/clj-time>

ãŠãã‚‰ããƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãªClojure ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª.

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®[Java: Joda-Time API]({{< relref "20220816064530.md#5241d177-9efa-401e-9334-d0238370f149" >}})ã®ãƒ©ãƒƒãƒ‘ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒª.

ã—ã‹ã—æ³¨æ„æ›¸ãã¨ã—ã¦ Java8ä»¥é™ã¯Java Timeã‚’ãƒ©ãƒƒãƒ—ã—ã¦ã„ã‚‹ [clojure.java-time](#6f76660f-c632-4464-8e1d-fded6e0a94ad) ã‚’ä½¿ã£ãŸã»ã†ãŒã„ã„ã¨ã®ã“ã¨.

Javaã§ã¯Java8ã‚ˆã‚ŠJava Timeã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæ¨™æº–ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Š, ãã‚Œä»¥å‰ã«ä½¿ã‚ã‚Œã¦ã„ãŸ Joda Timeã‚’ç½®ãæ›ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸ.

ãã®ãŸã‚clojureã®æ–¹é‡ã¨ã—ã¦ã‚‚Joda Timeã§ã¯ãªãJava Timeã‚’ã¤ã‹ã†ã®ãŒã„ã„.


## clojure.java-time {#6f76660f-c632-4464-8e1d-fded6e0a94ad}

A Clojure wrapper for Java8 [Java: Date Time API]({{< relref "20220816064530.md#22e57af1-e0e9-4875-8351-4ab7ec98f645" >}}).

<https://github.com/dm3/clojure.java-time>


### <span class="org-todo todo _">âœ…</span> æ–‡å­—åˆ—ã¯parseã™ã‚‹ã«ã¯? {#86d5ec}

local-date-timeã‚„zoned-date-timeã®ç¬¬ä¸€å¼•æ•°ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ–‡å­—åˆ—ã‚’æ¸¡ã™.

æ³¨æ„ç‚¹ã¯, Tã‚„Zã¯ã¯('')ã§å›²ã‚€ã“ã¨.

```clojure
(def format "yyyy-MM-dd'T'HH:mm:ss")
(def timestamp "2022-08-16T02:25:24")
(t/local-date-time format timestamp)
```


## Java Libraries Interop {#be7699}

Javaã®é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã‚‚ã„ã„.

SimpleDataFormatã‚’ä½¿ã†ä¾‹.

```clojure
(import '[java.text SimpleDateFormat])

(def twitter-timestamp "Sat Mar 12 20:34:57 +0000 2022")
(def twitter-format "EEE MMM dd HH:mm:ss Z yyyy")

(def locale java.util.Locale/US)
(def sdf (SimpleDateFormat. twitter-format locale))

(.setTimeZone sdf (java.util.TimeZone/getTimeZone "Asia/Tokyo"))
(.parse sdf twitter-timestamp)
```

ref: [ğŸ“Clojure Java Interop]({{< relref "20220117172324.md" >}})


## âœ…Clojure Date/Time Tips {#0c385c}


### ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ã™ã‚‹ {#350f18}

Javaã‚’å‘¼ã³å‡ºã™ã‹, clj-time/java-timeã‚’ã¤ã‹ã†.

ä»¥ä¸‹ã¯Javaç›´æ¥å‘¼ã³å‡ºã—.

```clojure
;; deplicated
(defn now []
  (java.util.Date.))
;; prefer
(defn now []
  (java.time.LocalDateTime/now))
```


## ğŸ”—References {#3b90d2}

-   [Clojureã§Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¤ãã‚‹ã¨ãã«ã€Joda-Timeã«ä¾å­˜ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ - ayato-p](https://scrapbox.io/ayato-p/Clojure%E3%81%A7Web%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E3%80%81Joda-Time%E3%81%AB%E4%BE%9D%E5%AD%98%E3%81%97%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B)
-   [clojureã§æ—¥ä»˜/æ™‚åˆ»ã‚’æ‰±ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¯”è¼ƒã—ã¦ã¿ã‚‹ | 10nin.com](https://www.10nin.com/clojure/datetime/library/2021/02/24/clj-time.html)
