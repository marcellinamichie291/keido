+++
title = "ğŸ“Clojure Functional Programming"
lastmod = 2022-09-11T22:23:51+09:00
tags = ["Clojure", "WIKI"]
draft = false
+++

ã„ã‚ã‚†ã‚‹é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã§ç™»å ´ã™ã‚‹ç”¨èªã®Clojureå®Ÿç¾æ–¹æ³•.

-   up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})
-   tags.
    -   [ğŸ·Functional Programming]({{< relref "20220305080412.md" >}})
-   links
    -   [Clojure - Clojureã‚’å­¦ã¼ã† - é–¢æ•°](https://japan-clojurians.github.io/clojure-site-ja/guides/learn/functions)


## Clojure: Function {#01f98f}

**defn** ã§å®šç¾©.

ref: [ğŸ”—Clojure - Learn Clojure - Functions](https://clojure.org/guides/learn/functions) [ğŸ·Function]({{< relref "20220305075933.md#769e0bdf-4553-4222-96f8-f47688a5ad26" >}})


### Clojure: Multi-arity Functions {#0a85be93-a9cb-4f70-a5f2-5bf209a45d32}

Multi-arity functionsã‚’ã‚µãƒãƒ¼ãƒˆ. arityã¯ã‚¢ãƒªãƒ†ã‚£ã¨ç™ºéŸ³ã™ã‚‹, é–¢æ•°ã®å–ã‚Šã†ã‚‹å€‹æ•°. ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã¨åŒç¾©.

```clojure
(defn messenger
  ([]     (messenger "Hello world!"))
  ([msg]  (println msg)))
```

ref: [ã‚¢ãƒªãƒ†ã‚£]({{< relref "20220305080412.md#756166a4-915b-42cd-b0ba-1db06e09121a" >}}) [ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰]({{< relref "20220310125619.md#64f4225b-e594-4f4a-8de5-146020ce5c91" >}})


### Clojure: å¯å¤‰é•·å¼•æ•°é–¢æ•° | Variadic Functions {#11aa1008-04ee-4554-9ebd-67470c0fc93f}

[å¯å¤‰é•·å¼•æ•°]({{< relref "20220305075933.md#e180be51-784e-4e9d-ba21-5c0e172b8918" >}}) ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°, variadic = å¯å¤‰é•·, aka. ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°.

Clojureã§ã¯ **&** ã‚’ç”¨ã„ã¦æŒ‡å®šã™ã‚‹.

```clojure
(defn hello [greeting & who]
  (println greeting who))
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ãŒé–¢æ•°å‘¼ã³å‡ºã—ã¦ã§æŒ‡å®šã•ã‚Œãªã„å ´åˆã¯nilãŒbindã•ã‚Œã‚‹.

æ³¨æ„ç‚¹ã¯, variadic valueã¯ãƒªã‚¹ãƒˆã§æŸç¸›ã•ã‚Œã‚‹ã“ã¨. ã“ã‚Œã¯[Clojure: apply ](#f596204e-e198-4042-a21f-608c35e86fbf)ã§ç„¡åé–¢æ•°ã‚’å¯å¤‰é•·å¼•æ•°ã«é©å¿œã—ãŸã„ã¨ã„ã†ç†ç”±ã§ã“ã†ãªã£ã¦ã„ã‚‹ã¨æ¨æ¸¬ã—ã¦ã„ã‚‹.

ãƒªã‚¹ãƒˆã®ä¸­èº«ã‚’å¤‰æ•°ã«bindã—ã¦ä½¿ã†ã«ã¯[Clojureã®åˆ†é…æŸç¸›]({{< relref "20220116094552.md" >}})ãŒä¾¿åˆ©.

Vectorã®å ´åˆ.

```clojure
(defn fn-test1 [a & b] b)
(fn-test1 1 2) ;=> (2)

(defn fn-test2 [a & [b]] b)
(fn-test2 1 2) ;=> 2
```

Mapã®å ´åˆ.

```clojure
(defn fn-test3 [a & b] b)
(fn-test1 1 {:c 1}) ;=> ({:c 1})

(defn fn-test4 [a & {:as b}] b)
(fn-test3 1 {:c 1}) ;=> {:c 1}
```

---

ref. [Clojure - Destructuring in Clojure](https://clojure.org/guides/destructuring)


#### <span class="org-todo todo _">ğŸ’¡</span> å°æŠ€: ä½•ã§ã‚‚ã„ã„ã®ã§å¼•æ•°ã‚’æ¸¡ã™ {#e02215}

& _ ã§è¡¨ç¾ã™ã‚‹.

```clojure
(defn [& _]... )
```


### Clojure: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° {#bb6074dc-75c7-41ac-b2ac-ca4c8d1dd5a5}

[ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°]({{< relref "20220305075933.md#4c510cea-aa58-487e-b766-8a164dd1351f" >}})ã¯Clojureã«ã¯ãªã„. ã—ã‹ã—[Clojure: åˆ†é…æŸç¸›]({{< relref "20220116094552.md" >}})ã«ã‚ˆã‚Šå®Ÿç¾ãŒã§ãã‚‹.

ã“ã†æ›¸ã.

```clojure
(defn hoge [& {:keys [a b]}]
   ... )

(hoge :a 1 :b 2)
```

---

ã•ã‚‰ã«, Clojure 1.11: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚’ã¨ã‚‹é–¢æ•°ã«ãƒãƒƒãƒ—ãŒæ¸¡ã›ã‚‹ã‚ˆã†ã«ãªã£ãŸ.

ref. [Clojure Language Update 2021 - Qiita](https://qiita.com/athos/items/bd0c02c7988f99ef8d25#%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E5%BC%95%E6%95%B0%E3%82%92%E3%81%A8%E3%82%8B%E9%96%A2%E6%95%B0%E3%81%AB%E3%83%9E%E3%83%83%E3%83%97%E3%81%8C%E6%B8%A1%E3%81%9B%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB)

ã¤ã¾ã‚Šä¸¡æ–¹ã„ã‘ã‚‹.

```clojure
(hoge :a 1 :b 2)
(hoge {:a 1 :b 2})
```

[é–¢æ•°ã¯Seqã‹Associativeã‚’å…¥åŠ›ã—Seqã‹Associativeã‚’å‡ºåŠ›ã™ã‚‹]({{< relref "20220116161735.md#0e0467d6-3858-46bf-b7da-d684907d237d" >}})ã¨ã„ã†Clojureã®ãƒ‡ãƒ¼ã‚¿ã¨é–¢æ•°ã®ä¸–ç•Œè¦³ã«å¾“ã£ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ããªã‚‰ã°, ã‚ã‚‹functionã«ã¯ã„ã£ã¦ããŸMapã‚’ãã®ã¾ã¾ã‚µãƒ–ã®å°ã•ãªé–¢æ•°ã«å‡¦ç†ã•ã›ãŸã„ã¨ãã«thisã§ã¯ã„ã£ã¦ããŸã‚‰ãã‚Œã«ãªã‚“ã‹assocã—ã¦ã‚µãƒ–é–¢æ•°ã«ã‚ãŸã—ãŸã„. ã“ã†ã„ã†ã‚±ãƒ¼ã‚¹ã«ãŠã„ã¦Mapã‚’ãã®ã¾ã¾æ¸¡ã›ã¡ã‚ƒã£ãŸã»ã†ãŒä¾¿åˆ©.


### defun: Clojureã§ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒã‚¯ãƒ­ {#298fe9ed-53f2-42ab-b80d-bcfa03527c4a}

é–¢æ•°ã«[ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ]({{< relref "20220305080412.md#75679e4f-f71d-4ec2-a4f5-ea3bc88f352d" >}})ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ãƒã‚¯ãƒ­. ã‚‚ã—xxãªã‚‰ã°yyã™ã‚‹ã®ã‚ˆã†ãªæ¡ä»¶ã®ç¾…åˆ—ã‚’ã‚­ãƒ¬ã‚¤ã«è¨˜è¿°.

core.matchã®å½¢å¼ã§æ¡ä»¶ã‚’ [Multi-arity Functions](#0a85be93-a9cb-4f70-a5f2-5bf209a45d32) ã®å½¢å¼ã§å‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ãŒã§ãã‚‹.

[killme2008/defun](https://github.com/killme2008/defun)

ref. [Clojureã«ãŠã‘ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°~defunãƒã‚¯ãƒ­~ - Qiita](https://qiita.com/Haar/items/0f1444b4b4f5e7dd8817)

---

erlangã‚„ [ğŸ“Elixer]({{< relref "20220518064053.md" >}}) ã‹ã‚‰ã®ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ¤ã¨ã‹.

ref. [ğŸ”—ãªãœåƒ•ã®ä¸­ã§ElixirãŒä¸€ç•ªã§ã‚ã‚Šç¶šã‘ã‚‹ã®ã‹ | ã•ã‚“ã½ã—ã®æ•£æ­©è¨˜](https://sanposhiho.com/posts/2020-03-30-qiita-a66538451c145af73d5a/)

ã“ã®è¨˜äº‹ã§ã¯ Exixerã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã‚’çµ„ã¿åˆã‚ã›ã¦æµã‚Œã‚‹ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãé­…åŠ›ãŒèªã‚‰ã‚Œã¦ã„ã‚‹.

åŒã˜ã“ã¨ã‚’ Clojureã§ã‚„ã‚ã†ã¨ã™ã‚‹ãªã‚‰ã° [cond-> æ¡ä»¶ã¤ãã‚¹ãƒ¬ãƒƒãƒ‰ãƒã‚¯ãƒ­]({{< relref "20220116081924.md#edc8041c-a7eb-4b51-8433-f8b1038b3ffc" >}}) ã®æ©Ÿèƒ½ãŒãã‚Œã«è©²å½“ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒ,

> é•·ã„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­ã¯åˆ¥é–¢æ•°ã¨ã—ã¦åˆ‡ã‚Šå‡ºã™ã¹ã

ãªã‚‹ã»ã©ãŸã—ã‹ã«å°ã•ãªé–¢æ•°ã«åˆ‡ã‚Šå‡ºã—ã¦ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã—ãŸã»ã†ãŒè¦‹ãŸç›®ãŒã„ã„å ´åˆãŒã‚ã‚‹.


## Clojure: ç„¡åé–¢æ•° {#3af624}

Clojureã§ã¯ç„¡åé–¢æ•°ã¯ **fn** ã§å®šç¾©ã™ã‚‹. ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ **#()** ã§ã‚‚è¡¨ç¾å¯èƒ½.

---

[ğŸ·ç„¡åé–¢æ•°]({{< relref "20220305080412.md#3d7a1bdb-67c4-4e78-bd96-7ba400917c15" >}}) [ğŸ·ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£]({{< relref "20220305080412.md#f2673c74-7309-4fa1-a7f9-71ab7fe059f6" >}})


### Clojure: constantly {#b73d0475-f73e-4006-a9df-6a5a262e2ec5}

constantlyã¯ å¼•æ•°ã‚’å—ã‘å–ã£ã¦ç„¡åé–¢æ•°ã‚’è¿”ã™.

APIãªã©3rd party ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ãŠã†ã¨æ€ã£ãŸã¨ãå¼•æ•°ã«é–¢æ•°ã‚’æŒ‡å®šã—ãªã„ã¨ä½¿ãˆãªã„ã¨ãã«å¼•æ•°ã‚’æ¸¡ã™ãŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯.

ref. [evaluation - When to use \`constantly\` in clojure, how and when are its arguments evaluated? - Stack Overflow](https://stackoverflow.com/questions/4016995/when-to-use-constantly-in-clojure-how-and-when-are-its-arguments-evaluated)


### Clojure: complement {#b8522075-35e0-4565-8ec3-9665d4ddef13}

é–¢æ•°ã‚’å—å–ã‚Š, é–¢æ•°ã‚’è©•ä¾¡ã—ãŸçµæœã®åå¯¾ã®çœŸå½ã‚’è¿”ã™ç„¡åé–¢æ•°ã‚’è¿”ã™.

notã®ã‚ã‹ã‚Šã‚„ã™ã„åå‰ã‚’ã¤ã‘ã‚‹ã¨ãã«ä½¿ãˆã‚‹. (ã¤ã¾ã‚Š defã«ã‚ˆã£ã¦è‰¯ã„åå‰ã§æŸç¸›ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…).

```clojure
(def not-empty? (complement empty?))

(not-empty? [])    ;;=> false
(not-empty? [1 2]) ;;=> true
```

ref: [complement - ClojureDocs](https://clojuredocs.org/clojure.core/complement)


#### ğŸ¤”complementä¸è¦è«– {#31fc3591-4f6b-4ea2-b8cd-9227226606ec}

complementã¨notã¯åŒã˜çµæœãªã®ã§ã‚ã‹ã‚Šã«ãã„ã ã‘, ä¸è¦ã¨ã®ã“ã¨.

[ğŸ’¡Prefer anonymous functions over complement, comp and partial, as this results in simpler code most of the time.](#0e5a09a1-4600-414e-8309-6440d3a2ba6e)

ã“ã®è©±é¡Œã«å¯¾ã™ã‚‹æ·±å €ã‚Šã®è­°è«–.

[Is complement and not effectively the same in Clojure? - Stack Overflow](https://stackoverflow.com/questions/29097033/is-complement-and-not-effectively-the-same-in-clojure)

ãŸã—ã‹ã«not ã¨ complementã¯åŒã˜çµæœã«ãªã‚Š, ãã‚Œã¯å®Ÿè£…ã‚’ã¿ã‚‹ã¨ã•ã‚‰ã«ãã‚ŒãŒã‚ã‹ã‚‹.

æ„å‘³åˆã„ãŒé•ã†, notã¯å€¤ã‚’è¿”ã—ã¦complementã¯é–¢æ•°å€¤ã‚’è¿”ã™, ã—ã‹ã—ã¾ã‚çµæœã¯åŒã˜. ã‚ã¨ã¯ä½¿ã†ã‹ã©ã†ã‹ã¯ãã®äººã®ä¾¡å€¤è¦³ã‹ãª.

ã‚ãŸã—ã¯complementã¯ä½¿ã£ã¦ã‚‚ã„ã„ã‹ãª, é–¢æ•°å€¤ã‚’æ„è­˜ã—ã¦ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãŸã„ã®ã§.


### tips: ä»»æ„å¼•æ•°ã‚’æ¸¡ã™ {#c7a544}

(fn [& \_])ã§ä»»æ„å¼•æ•°ã‚’å—ã‘å–ã‚‹ç„¡åé–¢æ•°ãŒå®šç¾©ã§ãã‚‹.


## Clojure: é–¢æ•°é©ç”¨ {#e5cdec}

-   apply: é–¢æ•°é©ç”¨
-   partial: éƒ¨åˆ†é©ç”¨.
-   comp: é–¢æ•°åˆæˆ.


### Clojure: apply | é–¢æ•°é©ç”¨ {#f596204e-e198-4042-a21f-608c35e86fbf}

ç„¡åé–¢æ•°fnã‚’å¼•æ•°ãƒªã‚¹ãƒˆargsã«é©ç”¨ã™ã‚‹.

ä»¥ä¸‹ã®ï¼’ã¤ãŒåŒã˜ã“ã¨ã‚’ã—ã¦ã„ã‚‹.

-   (apply str ["str1" "str2" "str3"])
-   (str "str1" "str2" "str3")

ref: [Clojure - Clojureã‚’å­¦ã¼ã† - é–¢æ•°](https://japan-clojurians.github.io/clojure-site-ja/guides/learn/functions#_%E9%96%A2%E6%95%B0%E3%82%92%E9%81%A9%E7%94%A8%E3%81%99%E3%82%8B)


### Clojure: partial |  éƒ¨åˆ†é©ç”¨ {#9d9dcd2b-d324-450b-a4f2-2c1c6d5c9946}

Clojureã§ã¯partialã®è¡¨è¨˜ã‚’åˆ©ç”¨ã—ã¦éƒ¨åˆ†é©ç”¨ã™ã‚‹.

è¤‡æ•°ã®å¼•æ•°ã‚’å–ã‚‹é–¢æ•°ã®å ´åˆ, partialã§é©ç”¨ã§ãã‚‹ã®ã¯ã¯ã˜ã‚ã®å¼•æ•°ã®ã¿ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„(left-apply).

éƒ¨åˆ†é©ç”¨ã¯ä¸€éƒ¨ã®å¼•æ•°ã‚’å›ºå®šã—ãŸç„¡åé–¢æ•°ã‚’è¿”ã™ã“ã¨ã«ã™ããªã„ãŸã‚, 2ã¤ç›®ç§»è¡Œã®ä»»æ„ã®å¼•æ•°ã‚’å›ºå®šã™ã‚‹ã«ã¯è‡ªåˆ†ã§ç„¡åé–¢æ•°ã‚’æ›¸ãã“ã¨ãŒå¿…è¦.

```clojure
(defn foo [x y z]
    (+ x y z))

;; partialã ã¨xã—ã‹å›ºå®šã§ããªã„.
(def foo1 (partial foo 1))

(def foo2
  (fn [x z] (foo x 2 z)))

(def foo3
  (fn [x y] (foo x y 3)))
```

ref: [éƒ¨åˆ†é©ç”¨]({{< relref "20220305080412.md#49c07e1e-b28f-42c2-a8ef-5daae6e29c15" >}})

---

partialéæ¨å¥¨. ã‚ã‹ã‚Šã«ãã„.

[ğŸ’¡Prefer anonymous functions over complement, comp and partial, as this results in simpler code most of the time.](#0e5a09a1-4600-414e-8309-6440d3a2ba6e)


### Clojure: comp | é–¢æ•°åˆæˆ {#bf063f90-3447-4d70-bfa0-0ef6112e8aac}

è¤‡æ•°ã®éƒ¨åˆ†é–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã®ã¯compã‚’ã¤ã‹ã†.

[Threading Macros]({{< relref "20220116081924.md#508f51c6-37cb-4b61-9bce-91075f1f067e" >}}) ã¯ ãƒ•ã‚©ãƒ¼ãƒ ã‚’è©•ä¾¡ã—ãŸçµæœã§ã‚ã‚Š compã¯è©•ä¾¡ã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã‚ã‚‹.

```clojure
(def proc-comp (comp proc1 proc2 proc3))
(def proc-next (fn [x] (proc3 (proc2 (proc1 x))))
(proc-comp x)
(proc-nest x)
```

```clojure
(-> x
    (proc1)
    (proc2)
    (proc3))
```

---

compè¦šãˆãªãã¦ã„ã„ã‹ã‚‚.

[ğŸ’¡Prefer anonymous functions over complement, comp and partial, as this results in simpler code most of the time.](#0e5a09a1-4600-414e-8309-6440d3a2ba6e)


### Clojure: juxt {#1807b0b4-4cf1-40c1-a08d-2cf37af30c46}

è¤‡æ•°ã®é–¢æ•°ã‚’å—ã‘å–ã£ã¦æ–°ã—ãé–¢æ•°ã‚’è¿”ã—, ãã®é–¢æ•°ã¯å—ã‘å–ã£ãŸå¼•æ•°ã‚’ãã‚Œãã‚Œã®é–¢æ•°ã«é©ç”¨ã—ãŸçµæœã‚’vectorã§è¿”ã™.

ex.) ((juxt a b c) x) => [(a x) (b x) (c x)]

ref: [filter ã¨ remove ã®ãµãŸã¤ã®çµæœã‚’ç°¡å˜ã«å—ã‘å–ã‚‹æ–¹æ³• - Qiita](https://qiita.com/ayato_p/items/db4d6bd8d453f14e13e2)

---

multimethodã§ã®å¿œç”¨ã‚‚ä¾¿åˆ©. ã‚ã‚‹Mapã‚’å—ã‘å–ã£ã¦keyã‚„ã‚ã‚‹å‡¦ç†ã‚’å…ƒã«å¾—ã‚‰ã‚ŒãŸçµæœã«ã‚ˆã£ã¦ç•°ãªã‚‹é–¢æ•°ã‚’dispatchã—ãŸã„ã¨ãã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹.

```clojure
;; Define the multimethod
(defmulti service-charge (juxt account-level :tag))

;; Handlers for resulting dispatch values
(defmethod service-charge [::acc/Basic   ::acc/Checking] [_] 25)
(defmethod service-charge [::acc/Basic   ::acc/Savings]  [_] 10)
(defmethod service-charge [::acc/Premium ::acc/Account]  [_] 0)
```


## Clojure: åˆ†é…æŸç¸›(Destructuring) {#238e85}

-> [Clojure: åˆ†é…æŸç¸›(Destructuring)]({{< relref "20220116094552.md" >}})


## Clojure: é…å»¶è©•ä¾¡/é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹(Laziness Evaluation/Laziness Sequence) {#4f51982f-85bd-4e92-a85e-12cf66360653}

é…å»¶è©•ä¾¡ã¨ã¯, å€¤ãŒå¿…è¦ã«ãªã‚‹ã¾ã§å¼ã®è©•ä¾¡ã‚’é…ã‚‰ã›ã‚‹ã“ã¨.

-   rangeã§, é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®æ•°åˆ—ã‚’ä½œæˆã§ãã‚‹.
-   repeatã§, é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®ã‚·ãƒ³ãƒœãƒ«ã®ç¹°ã‚Šè¿”ã—ãŒä½œæˆã§ãã‚‹.
-   repeatedlyã§, æŒ‡å®šå›æ•°ã ã‘ç„¡åé–¢æ•°ã‚’é©ç”¨ã—ãŸã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ä½œæˆã§ãã‚‹.
-   iterateã§, é–¢æ•°é©ç”¨ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ä½œæˆã§ãã‚‹. æ•°å­¦ã®æ¼¸åŒ–å¼.

é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®å®Ÿç¾ã«ã¯ doall, dorunã‚’åˆ©ç”¨ã™ã‚‹.

-   refs.
    -   [Clojureã®ç¹°ã‚Šè¿”ã—: map vs doseq]({{< relref "20220116081924.md#cb2449fb-2bed-4b5d-8633-5ce00723f7fa" >}})
    -   [Lazy Evaluation: é…å»¶è©•ä¾¡]({{< relref "20220305075933.md#16d2809f-4277-42c4-aa72-f55a873b5feb" >}})


### ğŸ’¡ãã‚‚ãã‚‚ãªãœClojureã¯è¨­è¨ˆæ€æƒ³ã¨ã—ã¦é…å»¶è©•ä¾¡ãªã®ã‹ï¼Ÿ {#c502f03c-2230-4414-9798-a410901702d5}

-   refs.
    -   [lazy-seq in Clojure (ç¿»è¨³ by Takanori Ishibashi)](https://11takanori.medium.com/lazy-seq-in-clojure-%E7%BF%BB%E8%A8%B3-8fba0ebcb6af)
    -   [ğŸ·Clojure Way]({{< relref "20220116161735.md" >}})


## Clojure: å†å¸° {#4b1437}

[Clojure: å†å¸°(loop/recur)]({{< relref "20220116081924.md#bb2bfd77-1869-4ccd-b1ef-13aae57706c1" >}})ã«ç§»å‹•.

é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒé›£ã—ã„ã¨ã„ã‚ã‚Œã‚‹ç†ç”±ã®ä¸€ã¤. å®Ÿã¯å†å¸°ä»¥å¤–ã¯ãã‚“ãªã«é›£ã—ããªã„ã—æ…£ã‚Œã‚‚ã‚ã‚‹ã¨æ€ã†.


## Clojure: é«˜éšé–¢æ•°(map/filter/reduce) {#6c6b2d}

Clojureã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ“ä½œ(map/filter/reduce)ä»–ã®ã¾ã¨ã‚.

-   mapã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«é–¢æ•°ã‚’é©ç”¨ã—ã¦ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’è¿”ã™.
-   filterã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®è¦ç´ ã®ãã‚Œãã‚Œã«predicateã‚’é©ç”¨ã—ã¦trueã®è¦ç´ ã®ã¿ã‚’å–ã‚Šå‡ºã™.
-   reduce ã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’accuumurateã—ã¦å˜ä¸€ã®æˆ»ã‚Šå€¤ã‚’è¿”ã™.
-   forã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’é †ç•ªé€šã‚Šã«é€šã‚Šã«å–ã‚Šå‡ºã™.
    -   æ‰‹ç¶šãçš„ã«å‡¦ç†ã—ãŸã„å ´åˆã«ä½¿ã†.
    -   pythonã®foreach, zipçš„ãª.
-   flattenã¯å…¥ã‚Œå­æ§‹é€ ã®é…åˆ—ã‚’å˜ä¸€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«å¤‰æ›ã™ã‚‹.

---

æœ‰é™ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã¯ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ã‚‚ã‚ã‚‹.

[ğŸ’¡Clojureã®ç¹°ã‚Šè¿”ã—: map vs doseq(for)]({{< relref "20220116081924.md#cb2449fb-2bed-4b5d-8633-5ce00723f7fa" >}})

---

ã„ã‚ã„ã‚ã‚ã‚‹ãŒæ‰‹ã‚’å‹•ã‹ã—ã¦è¦šãˆãŸã»ã†ãŒã„ã„. åŸºæœ¬çš„ãªæ©Ÿèƒ½ã¯ä»–ã®è¨€èªã§ã‚‚ã‚ã‚‹ã®ã§ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’è¦šãˆã‚‹ã®ã¿.æ‰‹ç¶šãçš„ãªãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‹ã‚‰è„±å‡ºã™ã‚‹ãŸã‚ã«ã‚‚èº«ã«ç€ã‘ãŸã„ã¨ã“ã‚.

ref. [ğŸ“Clojure Tips]({{< relref "20220302101805.md" >}})

ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«ã¯ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚‚ã„ã‚ã„ã‚ã‚ã‚‹ã®ã§ãã®éƒ½åº¦è¦šãˆã‚ˆã†.

ref. [ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®åˆ†é›¢ã¨åˆæµãƒ†ã‚¯ãƒ‹ãƒƒã‚¯]({{< relref "20220302101805.md#f3e035f4-a23e-435d-a1e3-903e33dc9d49" >}})


### Clojure map {#a667056d-aa33-4e16-8689-ed4de0d46e8b}

mapã¯ [é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹](#4f51982f-85bd-4e92-a85e-12cf66360653) ã‚’æ§‹ç¯‰ã—, [dorun/doall]({{< relref "20220116081924.md#dea9ae38-ea8d-476e-a04e-0149bf17766a" >}}) ãªã©ã§å¼·åˆ¶è©•ä¾¡ã—ã¦ã¯ã˜ã‚ã¦ãƒªã‚¹ãƒˆãŒé †æ¬¡å®Ÿè¡Œã•ã‚Œã‚‹.

[ğŸ”–map]({{< relref "20220305080412.md#e41acc92-e157-46c9-b156-6db4692cbf75" >}})


#### clojure pmap {#ee032a}

pmapã¯é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ã‚‚ã®ã®, doallã§è©•ä¾¡ã™ã‚‹ã¨ãƒªã‚¹ãƒˆãŒãƒ‘ãƒ©ãƒ¬ãƒ«ã«ä¸¦åˆ—å®Ÿè¡Œã•ã‚Œã¦çµæœãŒãƒªã‚¹ãƒˆã§è¿”ã•ã‚Œã‚‹(Java Futureã‚’å†…éƒ¨ã§åˆ©ç”¨).

ref. [pmap - clojure.core | ClojureDocs](https://clojuredocs.org/clojure.core/pmap)

ä»¥ä¸‹ã®ï¼’ã¤ã§ã¯å®Ÿè¡Œæ™‚é–“ã«4å€ã®å·®ãŒç”Ÿã¾ã‚Œã‚‹.

```clojure
(defn long-running-job [n]
    (Thread/sleep 3000)
    (+ n 10))

(doall (map long-running-job (range 4)))
(doall (pmap long-running-job (range 4)))
```

ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã®ã¨ãã«å¨åŠ›ã‚’ç™ºæ®.


### clojure: filter {#2f67d978-d850-4251-9ea4-c75f95f2991e}

ä¸ãˆã‚‰ã‚ŒãŸã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰æ¡ä»¶ã«åˆã†ã‚‚ã®æŠœãå‡ºã™.

```clojure
(filter pred coll)
```

filterç³»ã¯æ´¾ç”Ÿé–¢æ•°ãŒã„ã‚ã„ã‚ã‚ã‚‹.

-   **remove** ã¯ filterã®é€†ã§æ¡ä»¶ãŒtrueã«ãªã‚‹ã‚‚ã®ã‚’å–ã‚Šé™¤ã.
-   **keep** ã¯ fã§è©•ä¾¡ã—ãŸçµæœãŒnilã§ãªã„ã‚‚ã®ã‚’æ®‹ã™.

---

tag: [ğŸ·filter]({{< relref "20220305080412.md#c2281cde-6c21-4b81-af21-f90118117836" >}})


### Clojure: reduce {#0b9df4a0-30ce-4e72-bcb5-c0d8f959ba0e}

Clojureã«ãŠã‘ã‚‹[ğŸ”–reduce]({{< relref "20220305080412.md#7fcda7c4-8879-4272-9e5a-8c10bc9339b2" >}})ã¾ã¨ã‚. Clojureã«ã¯[ğŸ“Clojure Transducer]({{< relref "20220331203002.md" >}})ã¨ã„ã†reduceã‚’æ‹¡å¼µã—ãŸä»•çµ„ã¿ãŒã‚ã‚‹.


#### reduced: reduceã‚’é€”ä¸­ã§æ‰“ã¡åˆ‡ã‚‹ {#0b66f7}

æ¡ä»¶ã«ãƒãƒƒãƒã—ãŸã‚‰reduceã‚’é€”ä¸­ã§æ‰“ã¡åˆ‡ã‚‹helperé–¢æ•°ã¨ã—ã¦reducedãŒã‚ã‚‹. loop/recurã§æ›¸ã„ã¦ã„ãŸå‡¦ç†ã‚‚reduceã§æ›¸ãã‚„ã™ããªã‚‹.

[reduced - clojure.core | ClojureDocs](https://clojuredocs.org/clojure.core/reduced)

```clojure
(defn limit [x y]
  (let [sum (+ x y)]
    (if (> sum 10) (reduced sum) sum)))

(reduce limit 0 (range 10))
;; => 15
```


#### take-while: ã‚ã‚‹æ¡ä»¶ã‚’æº€ãŸã™ã¾ã§å‡¦ç†ã‚’ç¶šã‘ã‚‹ {#998e27}

reducedã®ç™ºå±•ã§, predã‚’æº€ãŸã™ã¾ã§ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‹ã‚‰è¦ç´ ã‚’å–å¾—ã™ã‚‹.

ãŸã¨ãˆã°å…ˆé ­ã‹ã‚‰ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§timestampã‚’æ¡ä»¶ã«ã—ã¦å–å¾—ã™ã‚‹ãªã‚‰ã°, filterã‚ˆã‚Šã‚‚åŠ¹ç‡çš„ã§ã‚ã‚‹. ã¾ã—ã¦ã‚„laze-seqãªã©ã¯filterã‚ˆã‚Šã‚‚ãªãŠã•ã‚‰ã‚ˆã„.

[take-while - clojure.core | ClojureDocs](https://clojuredocs.org/clojure.core/take-while)


## Clojure é–¢æ•°ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°Topics {#9d9b8e}


### ğŸ’¡Clojureã§ã¯è‡ªå‹•ã‚«ãƒªãƒ¼åŒ–ã¯ãªã„ã®ã§è‡ªåˆ†ã§ç„¡åé–¢æ•°ã§ãªã‚“ã¨ã‹ã™ã‚‹ {#d178b8}

Clojureã§ã¯è‡ªå‹•[ã‚«ãƒªãƒ¼åŒ–]({{< relref "20220305080412.md#8f48b402-806e-4b51-b339-da38bd58211b" >}})(automatic currying)ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚‰ãš, éƒ¨åˆ†é©ç”¨é–¢æ•°partialã¨ã‹ç„¡åé–¢æ•°ã§æ‰‹å‹•ã‚«ãƒªãƒ¼åŒ–ã™ã‚‹.

ãŸã¨ãˆã°,

```clojure
(defn sum
  "Sum two numbers together"
  [number1 number2]
  (+ number1 number2))
```

ã¿ãŸã„ãªé–¢æ•°ã«ã“ã†ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼.

```clojure
(sum 1)
;; => clojure.lang.ArityException
;; => Wrong number of args (1) passed to: functional-concepts/sum
```

ãªã®ã§, ã“ã‚ŒãŒè‡ªåŠ›ã®æ‰‹å‹•ã‚«ãƒªãƒ¼?

```clojure
(defn sum-curry [x] (partial sum x y))
```

-   refs.
    -   [Currying & Partial Functions Â· Practicalli Clojure](https://practical.li/clojure/thinking-functionally/partial-functions.html)


### ğŸ’¡Prefer anonymous functions over complement, comp and partial, as this results in simpler code most of the time. {#0e5a09a1-4600-414e-8309-6440d3a2ba6e}

[The Clojure Style Guide](https://guide.clojure.style/#anonymous-functions-vs-complement-comp-and-partial)ã®Anonymous Functions vs complement, comp and partialã‚ˆã‚Š.

ç°¡å˜ã«ã„ã†ã¨, complement, comp, partialã‚ˆã‚Šã‚‚ç„¡åé–¢æ•°ã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã¨ã„ã†ã“ã¨. ãªãœãªã‚‰ã°å¤§ä½“ã®å ´åˆã«ãŠã„ã¦ç„¡åé–¢æ•°ã®ã»ã†ãŒã‚³ãƒ¼ãƒ‰ãŒã‚ã‹ã‚Šã‚„ã™ã„.

è©³ç´°ã¯ä»¥ä¸‹.

[When should I prefer comp and partial to anonymous functions? - Clojure Q&A](https://ask.clojure.org/index.php/8373/when-should-prefer-comp-and-partial-to-anonymous-functions)

ã¾ã‚ãã†ã‹ã‚‚ã—ã‚Œãªã„, [Clojure: complement](#b8522075-35e0-4565-8ec3-9665d4ddef13)ã¨ã‹å¿˜ã‚Œã¡ã‚ƒã†ã®ã§.

[ğŸ”–Clojure Style Guide]({{< relref "20220313110515.md#3b44f8d5-e1ad-483a-81eb-6a61650baf64" >}})

---

æ—¥æœ¬èªã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã®[ã‚«ãƒªãƒ¼åŒ–ã«ã¯ç„¡åé–¢æ•°ã‚ˆã‚ŠpartialãŒæœ›ã¾ã—ã„](https://totakke.github.io/clojure-style-guide/#partial) ã¨ã®è¨˜è¼‰ã¯é–“é•ã£ã¦ã„ã‚‹ã¨æ€ã†.

ã¨ã„ã†ã‚ˆã‚ŠãŸã¶ã‚“ç¿»è¨³ãŒã‹ã‹ã£ãŸã‚ã¨ã«2019ã®è¨˜äº‹ã§é€†è»¢ã—ãŸå¯èƒ½æ€§ã‚ã‚Š. ã¾ãŸã‚«ãƒªãƒ¼åŒ–ã¯partialãŒå¥½ã¾ã—ã„ã¨ã„ã†è¡¨ç¾ã¯[ğŸ’¡ã‚«ãƒªãƒ¼åŒ–ã¨éƒ¨åˆ†é©ç”¨ã®é•ã„]({{< relref "20220305080412.md#53cdd02a-9472-4558-adb7-33c272d9e567" >}})å•é¡Œã«ç›´é¢ã™ã‚‹ã®ã§ã‘ã£ã“ã†å±ã†ã„ã‹ã‚‚.


## Active Recalls {#b27a23}


### Clojureéƒ¨åˆ†é©ç”¨ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? éƒ¨åˆ†é©ç”¨ã®é™å®šçš„ãªæ€§è³ªã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#19d1c6}

partial.

Clojureã®éƒ¨åˆ†é©ç”¨ã§ã¯ç¬¬ä¸€å¼•æ•°ã®ã¿ã«ã—ã‹é©ç”¨ã™ã‚‹ã“ã¨ãŒã§ããªã„.

ç¬¬ï¼’å¼•æ•°ä»¥é™ã‚’å›ºå®šã—ãŸã„å ´åˆã¯ç„¡åé–¢æ•°ã§ä»£ç”¨ã™ã‚‹.

ex.) (partial grow "Alice")


### Clojureã§ï¼’ã¤ã®é–¢æ•°ã‹ã‚‰æ–°ãŸãªé–¢æ•°ã‚’è¿”ã™ãŸã‚ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã¨ã©ã†é•ã„ã¾ã™ã‹ï¼Ÿ {#ab86fe}

comp

ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã¯ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿”ã™ãŒcompã¯é–¢æ•°ã‚’è¿”ã™ãŸã‚å¼•æ•°ã‚’ã‚‚ã‚‰ã‚ãªã„é™ã‚Šãã‚Œè‡ªä½“ã§ã¯è©•ä¾¡ã§ããªã„.

ex.) (defn surprise [direction]
       ((comp oh-my toggle-grow) direction))


### é…åˆ—ã‚„ãƒãƒƒãƒ—ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®è¦ç´ ã‚’ãã®ã¾ã¾bindingã™ã‚‹æ–¹æ³•ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#d1de10}

åˆ†é…æŸç¸› - destructuring


### Clojureã®range, repeat, repeatedlyãŒå…±é€šã—ã¦ã‚‚ã¤æ€§è³ªã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#d14e40}

é…å»¶è©•ä¾¡ - Lazy Evaluation


### Clojureã«ãŠã„ã¦å†å¸°ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? {#acbfe2}

loop/recur. æœ«å°¾å†å¸°ãªã‚‰recur.


### Clojureã§æ¼¸åŒ–å¼ã®ã‚ˆã†ãªé…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹é–¢æ•°ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#10c210}

iterate


### Clojureã®constantly, complementã¯ãã‚Œãã‚Œã©ã‚“ãªå½¹å‰²ã§ã™ã‹ï¼Ÿ {#ebc958}

constantlyã¯å¼•æ•°ã‚’å—å–ã‚Šç„¡åé–¢æ•°ã‚’è¿”ã™.

complementã¯é–¢æ•°ã‚’å—å–ã‚Šãã®é–¢æ•°ã®è©•ä¾¡çµæœã®çœŸå½ã‚’ã²ã£ãã‚Šè¿”ã—ãŸç„¡åé–¢æ•°ã‚’è¿”ã™.


### Clojure: juxtã¯ã©ã‚“ãªå½¹å‰²ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ {#76ece6}

è¤‡æ•°ã®é–¢æ•°ã‚’å—ã‘å–ã£ã¦æ–°ã—ãé–¢æ•°ã‚’è¿”ã—, ãã®é–¢æ•°ã¯å—ã‘å–ã£ãŸå¼•æ•°ã‚’ãã‚Œãã‚Œã®é–¢æ•°ã«é©ç”¨ã—ãŸçµæœã‚’vectorã§è¿”ã™.

ex.) ((juxt a b c) x) => [(a x) (b x) (c x)]
