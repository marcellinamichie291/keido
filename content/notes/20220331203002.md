+++
title = "ğŸ“Clojure: Transducer"
lastmod = 2022-10-15T10:01:32+09:00
tags = ["WIKI", "Clojure"]
draft = false
+++

-   up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})


## ğŸ“Transducerã¨ã¯ {#1a8626}

Clojure 1.7ã‚ˆã‚Šè¿½åŠ ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒª.

-   [reduce(é«˜éšé–¢æ•°)]({{< relref "20220305080412.md#7fcda7c4-8879-4272-9e5a-8c10bc9339b2" >}}) ã®æ¦‚å¿µã‚’æ‹¡å¼µ.
-   åˆæˆå¯èƒ½ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¤‰æ›.
    -   é–¢æ•°åˆæˆ(comp)ã«ã‚ˆã‚Šçµ„ã¿åˆã‚ã›å¯èƒ½
    -   (transducer + transducer => transducer).
    -   composableãª [ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ‘ã‚¿ãƒ¼ãƒ³]({{< relref "20220309184220.md#c9cccb6b-0f42-4812-9219-e027dfe0f9db" >}}).
-   å…¥åŠ›æºã‚„å‡ºåŠ›å…ˆã«ã‚ˆã‚‰ãšå„è¦ç´ ã‚’å¤‰æ›.


### reducing functionã¨transducerã®å®šç¾© {#b1a62e}

ã¾ãšã¯ç”¨èªã®å®šç¾©, å¤§äº‹ãªã®ã§æ³¨æ„.

**reducing function** ã¨ã¯accumulateã•ã‚ŒãŸçµæœã¨æ–°ã—ã„inputã‚’åˆã‚ã›ã¦æ–°ã—ã„accumulateã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°. (accumulateãŒãªã‚“ã¨è¨³ã™ã®ã‹ã‚ã‹ã‚‰ãªã„ã‘ã©, ã„ã‚ã‚†ã‚‹reduceé–¢æ•°ã ).

> ;; reducing function signature
> whatever, input -> whatever

---

**transducer** ã¨ã¯ã‚ã‚‹reducing functionã‚’åˆ¥ã®reducing functionã«å¤‰æ›ã™ã‚‹.

> ;; transducer signature
> (whatever, input -> whatever) -> (whatever, input -> whatever)


### Transducerã®ä½œã‚Šæ–¹ {#4fffbf}

Clojureã®Collectionã‚’å‡¦ç†ã™ã‚‹é–¢æ•°ã®ã†ã¡collã‚’å¼•æ•°ã«æŒãŸãªã„å ´åˆã¯å¤§æŠµãã‚ŒãŒtransducerã®é–¢æ•°ã¨ãªã£ã¦ã„ã‚‹.

```clojure
(filter odd?) ;; å¥‡æ•°ã‚’ãƒ•ã‚£ãƒ«ã‚¿ã™ã‚‹ãƒˆãƒ©ãƒ³ã‚¹ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã‚’è¿”ã™
(map inc)     ;; incã«ã‚ˆã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’è¡Œã†ãƒˆãƒ©ãƒ³ã‚¹ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã‚’è¿”ã™
(take 5)      ;; æœ€åˆã®5ã¤ã®å€¤ã‚’å–å¾—ã™ã‚‹ãƒˆãƒ©ãƒ³ã‚¹ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã‚’è¿”ã™
```

ãã—ã¦ã“ã‚Œã‚‰ã®transducerã‚’çµ„ã¿åˆã‚ã›ã‚‹ã«ã¯ **comp** ã‚’ä½¿ã†.

```clojure
(def xf
  (comp
    (filter odd?)
    (map inc)
    (take 5)))
```


## Transducer Topics {#e8e44a}


### ğŸ’¡Transducerã¨ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­(->>)ã¨ã®é–¢ä¿‚ {#a131e4}

Transducerã¨ã¯mapã‚„filterã®collectionã‚’çœã„ã¦å¤‰æ›å‡¦ç†ã ã‘æŠœãå‡ºã—ã¦ã¾ã¨ã‚ãŸã‚‚ã®.

```clojure
(->> coll
    (map proc1)
    (filter proc2)
    (map proc3)
    (map proc4))
```

ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã§è¡¨ç¾ã•ã‚Œã‚‹ã‚ˆã†ãªï¼”ã¤ã®å‡¦ç†ã‚’ãŸã¨ãˆã°ï¼’ã¤ã‚’ã¾ã¨ã‚ã¦æ“ä½œã¨ã—ã¦æŠ½è±¡ã—ãŸã‚Š, ã•ã‚‰ã«ãã®é–¢æ•°å€¤ã‚’å¼•æ•°ã«ã™ã‚Œã°éƒ¨åˆ†çš„ã«äº¤æ›ãªéƒ¨å“ãŒã§ããŸã‚Šã™ã‚‹.


### Transducerã¨core.async {#85647a}

-   [ğŸ“Clojure core.async]({{< relref "20220118091058.md" >}})
-   [Clojure + core.async ã«ã‚ˆã‚‹éåŒæœŸï¼†ä¸¦åˆ—ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸–ç•Œ - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/core_async)


## ğŸ”—References {#3b90d2}

-   [Understanding Transducers - Elben Shira](http://elbenshira.com/blog/understanding-transducers/)
-   [ClojureScript Unraveled (2nd edition)](https://funcool.github.io/clojurescript-unraveled/#transducers)
-   [Reducers, Transducers, and core.async in Clojure - DZone Java](https://dzone.com/articles/reducers-transducers-and-coreasync-in-clojure)
-   [Reducers A Library and Model for Collection Proc - Rich Hickey - YouTube](https://www.youtube.com/watch?v=IjB-IOwGrGE)
    -   å…ˆç”Ÿã®reduceã«ã¤ã„ã¦ã®è©³ç´°è§£èª¬.

ã‚ã‚“ã¾ã‚Šæ—¥æœ¬èªæƒ…å ±ãªã„ãª...

-   [ãƒˆãƒ©ãƒ³ã‚¹ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼(transducer) - clojure.doc](https://japan-clojurians.github.io/clojure-site-ja/reference/transducers)
-   [å…¥é–€Transducers](https://www.slideshare.net/sohta/transducer-49916070)

JavaScriptã‚’ç”¨ã„ãŸtransduceã®æ¦‚å¿µã®èª¬æ˜.

-   [map, reduce ã‚‚ã„ã„ã‘ã© transduce ã‚‚ã­ - Qiita](https://qiita.com/41semicolon/items/666a3ff1c226828ecdb2)
-   [è¡æ’ƒãƒ¬ãƒãƒ¼ãƒˆï¼ï¼map, reduce ã®æœ¬è³ªã«ã›ã¾ã‚‹ï¼ - Qiita](https://qiita.com/41semicolon/items/7f31297dd104f97c61b0)


## See Also {#15ebdf}

-   [âš™Pipelineãƒ‘ã‚¿ãƒ¼ãƒ³]({{< relref "20220116195030.md#f65e0d32-5d7c-4ab5-a5cc-aab61182ff80" >}})
