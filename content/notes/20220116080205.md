+++
title = "ğŸ“Clojure Collections and Sequences"
lastmod = 2022-09-11T21:40:31+09:00
tags = ["WIKI"]
draft = false
+++

-   up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})
-   refs:
    -   [ğŸ“Clojure Idioms]({{< relref "20220302101805.md" >}})
    -   [ğŸ“Clojure Functional Programming]({{< relref "20220116094551.md" >}})

Clojureã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚„é«˜éšé–¢æ•°ã‚’å·§ã¿ã«æ‰±ã†ã“ã¨ãŒã§ãã‚‹ã¨ãƒ¢ãƒ†ã‚‹ã¨ã‹. ã“ã†ã„ã†ã®ã¯çŸ¥ã£ã¦ã„ã‚‹ã‹çŸ¥ã‚‰ãªã„ã‹ãªã®ã§ã‚¤ãƒ‡ã‚£ã‚ªãƒ ã‚’è¦šãˆã¦ãƒ¢ãƒ†ã‚ˆã†.


## Clojure: Collections {#310e6c}

Clojureã®Collectionã¯immutableã§persistent.

---

-   refs
    -   [ğŸ“immutable]({{< relref "20220114074914.md#fbc351d5-b1d2-4dcd-95cd-9d5021f88565" >}})
    -   [ğŸ“persistent]({{< relref "20220114074914.md#7e585ab7-a40f-4a1e-aeaa-812eb632f2ff" >}})
    -   [ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«æ™‚ä»£ã®è¨€èªã¨ã—ã¦ã®Clojure - Qiita](https://qiita.com/kawasima/items/c695e2f4ee079a6debf5)


### Clojure Collectionæ“ä½œ {#c18572}

ã‚ˆãä½¿ã†ã‚‚ã®ã‚’åˆ—æŒ™.

-   conj: ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®çµåˆ. ä»–ã®è¨€èªã§ã¯push, concat, appendã¨ã‹.


## Clojure Sequences(clojure.core.sequence) {#648d4030-475a-4dca-a0d9-5a6defcae18a}

refs: [Clojure - Clojureã‚’å­¦ã¼ã† - ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³](https://japan-clojurians.github.io/clojure-site-ja/guides/learn/sequential_colls)

ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å‹ ã«ã¯4ç¨®é¡ã®é‡è¦ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒã‚ã‚‹.

-   list: ()
-   vector: []
-   map: {}
-   set: #{}

[ğŸ”–List]({{< relref "20220310124045.md#aaef8de1-331f-431a-a5f4-39063b81f73d" >}})


### Clojure: into {#aec02797-3c3f-407e-95df-67073fa71b54}

into ã¯ç¬¬ä¸€å¼•æ•°ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«, ç¬¬äºŒå¼•æ•°ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®è¦ç´ å…¨ã¦ã‚’, å…ƒã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã¨ã£ã¦è‡ªç„¶ãªå½¢ã§è¿½åŠ  (conj) ã—ã¦ãã‚Œã‚‹é–¢æ•°.

(into %1 %2) ã¯,

(reduce conj %1 %2) ã¤ã¾ã‚Š %1 ã« %2 ã®è¦ç´ ã‚’é †ã« conj ã—ãŸã‚‚ã®ã¨åŒç­‰.

(conj (conj %1 %2ã®æœ€åˆã®è¦ç´ ) %2ã®äºŒç•ªç›®ã®è¦ç´ )ã¨åŒç­‰.


### ğŸ’¡Clojure contains?ã®ç½  {#15121a4d-3f9f-4294-a7ec-b025373adfc3}

ã“ã®å€¤ãŒãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ã¨ã, Clojureã®contains?ãŒã¤ã‹ãˆãªã„ã®ã§ç´›ã‚‰ã‚ã—ã„ã¨ã„ã†è©±é¡Œ.

[contains? - clojure.core](https://clojuredocs.org/clojure.core/contains_q)

ã“ã‚Œã¯Mapã«keyãŒå«ã¾ã‚Œã‚‹ã‹ã‚’åˆ¤å®šã™ã‚‹é–¢æ•°ã§ãƒªã‚¹ãƒˆã«å¯¾ã—ã¦ã¤ã‹ã£ã¦ã‚‚æœŸå¾…é€šã‚Šã®çµæœã«ãªã‚‰ãªã„...

ã“ã®å ´åˆ, someã ã£ãŸã‚ŠJavaã®.contains methodã‚’ã¤ã‹ã†.

```clojure
(defn in?
  "true if coll contains elm"
  [coll elm]
  (some #(= elm %) coll))

(.contains [100 101 102] 101)
```

ref. [data structures - Test whether a list contains a specific value in Clojure - Stack Overflow](https://stackoverflow.com/questions/3249334/test-whether-a-list-contains-a-specific-value-in-clojure)

---

æ–‡å­—åˆ—ã¯ã“ã£ã¡. [æ–‡å­—åˆ—ã‚’å«ã‚€ã‹ï¼Ÿ: clojure.core/includes?]({{< relref "20220428163355.md#ecab6dfc-90f5-4deb-b675-5a14420c8803" >}})


### ğŸ’¡Clojureã§Sliding window Algorithm {#55f4d3e9-7dad-4832-a284-a3f204207903}

[Sliding Window Algorithm]({{< relref "20220830152735.md#b07ffa38-60b1-4ae2-b130-d924e59f8ccb" >}})ã‚’Clojureã§implã™ã‚‹æ–¹æ³•.

-   [clojure - Sliding window over seq - Stack Overflow](https://stackoverflow.com/questions/1427894/sliding-window-over-seq)


### ğŸ’¡Clojureã§FIFOã‚­ãƒ¥ãƒ¼ã‚’æ‰±ã† {#c9d8db5f-1b0c-4cd7-ba8e-cdb54b9170df}

Clojure.lang.PersistentQueueã¨ã„ã†éš ã—æ©Ÿèƒ½ã‹ã‚ã‚‹ã‚‰ã—ã„.

Clojure.lang.PersistentQueue/EMPTYãŒç©ºã‚­ãƒ¥ãƒ¼ã‚’ç¤ºã™.

conj/pop/peekã§æ“ä½œ. é–²è¦§ã¯seqã§å¤‰æ›ã™ã‚‹.

---

æœ‰é™ã®ã‚­ãƒ¥ãƒ¼ãªã‚‰ä»¥ä¸‹ã®å®Ÿè£…ã§ã„ã‘ã‚‹.

```clojure
(defn push [v i n]
  (if (>= (count v) n) (conj (subvec v 1 n) i) (conj v i) ))
```

ref. [queue - Fixed length stack structure in Clojure - Stack Overflow](https://stackoverflow.com/questions/13353463/fixed-length-stack-structure-in-clojure)

---

-   [ğŸ”–queue]({{< relref "20220310124045.md#c7e19204-6111-4559-8978-cd93049cf076" >}})
-   [Queues in Clojure â€“ Michael Zavarella â€“ I don't edit anything I write](https://admay.github.io/queues-in-clojure/)
-   [ã‚¹ã‚¿ãƒƒã‚¯ã¨ã‚­ãƒ¥ãƒ¼ - tnoda-clojure](https://tnoda-clojure.tumblr.com/post/25798318986/stack-and-queue-in-clojure)


### <span class="org-todo todo _">ğŸ’¡</span> listã®ãƒãƒ¼ã‚¸ {#05fccf}

listã«å¯¾ã—ã¦mergeã‚’ã™ã‚‹ã¨æœŸå¾…é€šã‚Šã«ãªã‚‰ãªã„ç½ ãŒã‚ã‚‹.

```clojure
(merge '(1 2 3) '(4 5 6))
;; => ((4 5 6) 1 2 3)
```

ã“ã®å ´åˆ, **concat** ã‚’åˆ©ç”¨ã™ã‚‹. æˆ»ã‚Šå€¤ã¯Lazu Seqã«ãªã‚‹ã“ã¨ã«æ³¨æ„(input ãŒvectorã§ã‚‚seq).


## Clojure Map(clojure.core.map) {#30a935ff-4448-43a2-8ec7-8c37e18b6ca5}

-   assoc: (key, value)ã®è¿½åŠ 
-   dissoc: (key, value)ã®å‰Šé™¤
-   update: (key)ã®æŒ‡ã™(value)ã«å¼•æ•°ã§ä¸ãˆã‚‰ã‚ŒãŸé–¢æ•°ã‚’é©ç”¨ã—ã¦ç½®ãæ›ãˆã‚‹.
-   merge: (key, value)ã®é›†åˆã®è¿½åŠ 

assocã¯å€¤ã‚’æ›´æ–°ã—ã¦Mapã‚’è¿”ã™, updateã¯å€¤ã«é–¢æ•°ã‚’é©ç”¨ã—ã¦Mapã«æŸç¸›ã™ã‚‹. ã“ã®é–¢ä¿‚ã¯, [atomã§ã®reset! ã¨swap!ã®é•ã„]({{< relref "20220116191927.md#88423db9-b606-48ce-9a62-e6b3149d0514" >}}) ã«ä¼¼ã¦ã„ã‚‹.

mapã¯é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚, doall ãªã©ã®è©•ä¾¡ã¯åˆ¥é€”å¿…è¦.

ã—ã‹ã—doallã‚’ä¸€é€£ã®map/filter/reduceä¸­ã«æŒŸã‚€ã¨å‡¦ç†é€Ÿåº¦ãŒè½ã¡ã‚‹ãŸã‚å¿…è¦ãªã¨ãã®ã¿åˆ©ç”¨ã™ã‚‹. ã¾ãŸã¯é€æ¬¡å‡¦ç†ã§ã‚ã‚‹doseqã‚’æ¤œè¨ã™ã‚‹.

é€”ä¸­ã§ä¸­èº«ãŒå¿…è¦ã¨ã„ã†ã®ã¯ãã‚‚ãã‚‚mapã‚’å‘½ä»¤å½¢ã®foræ–‡ã®ãƒãƒªã§ä½¿ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„.

-   cf. [Clojureã®ç¹°ã‚Šè¿”ã—: map vs doseq]({{< relref "20220116083656.md#cb2449fb-2bed-4b5d-8633-5ce00723f7fa" >}})
-   ref. [Clojure: é…å»¶è©•ä¾¡/é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹]({{< relref "20220116094551.md#4f51982f-85bd-4e92-a85e-12cf66360653" >}})


## Clojureã«ãŠã‘ã‚‹Sequenceã¨Collectionã®é•ã„ {#86f363}

Clojureã§ã¯Collectionã¨Sequenceã¯ç•°ãªã‚‹æ¦‚å¿µ.

-   collection: ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æŠ½è±¡.
-   sequence: collectionã®ä¸­ã§ãƒ‡ãƒ¼ã‚¿ã‚’é †æ¬¡ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½(ã‚·ãƒ¼ã‚«ãƒ–ãƒ«)ãªã‚‚ã®.

Sequenceã¯Collectionã®ç‰¹æ®Šãªå½¢æ…‹ã§ã‚ã‚Šã€Collectionã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã®1ã¤.

å®Ÿè£…ãƒ¬ãƒ™ãƒ«ã§ã¯ coll?ã§çœŸãŒå¤‰ãˆã‚Œã°collection, seq?ã§çœŸãŒå¤‰ãˆã‚Œã°sequence.

collectionã¯IPersistentCollectionã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‚‚ã®.
IPersistentCollectionã¯5ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆcount, cons, empty, equiv, seqï¼‰ã‹ã‚‰ãªã‚‹.

sequenceã¯ISeqã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‚‚ã®.
ISeqã¯(first, next, more, cons)ã‹ã‚‰ãªã‚‹.

---

-   ref: Clojureã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æŠ½è±¡åŒ–ã‚’ç†è§£ã—ã¦ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®Ÿè£…ã™ã‚‹
    -   [Part 1: Collectionã¨ã¯ä½•ã‹ - æœ¬å½“ã¯æ€–ã„HPC](https://freak-da.hatenablog.com/entry/2015/08/05/222224)
    -   [Part 2: Sequenceã¨ã¯ä½•ã‹ - æœ¬å½“ã¯æ€–ã„HPC](https://freak-da.hatenablog.com/entry/2015/08/11/180047)


### ğŸ’¡Clojureãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œé–¢æ•°ã®åˆ†é¡ {#582983e0-0ed8-419e-aa14-c9b227ad42f9}

Clojureã®é–¢æ•°ã¯å¤§ããåˆ†ã‘ã¦ï¼’ã¤ã®ç¨®é¡ã«åˆ†ã‘ã‚‰ã‚Œã‚‹.

-   ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œã®é–¢æ•°(conj, disj, assoc, dissoc...)
-   ã‚·ãƒ¼ã‚±ãƒ³ã‚¹æ“ä½œã®é–¢æ•°(cons, map, filter, reduce..)

ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ“ä½œã™ã‚‹é–¢æ•°ã¯é–¢æ•°ã®æ¬¡ã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å—ã‘ã‚‹.
ä¸€æ–¹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹æ“ä½œã¯é–¢æ•°è©•ä¾¡å¼ã®æœ€å¾Œã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å—ã‘ã‚‹.

[Clojure: Threading Macros]({{< relref "20220116081924.md#508f51c6-37cb-4b61-9bce-91075f1f067e" >}}) ã«ã‚‚ 2ç¨®é¡ã‚ã‚‹ã®ã‚‚ã“ã‚ŒãŒé–¢ä¿‚ã—ã¦ã„ã‚‹.

ref: [Clojure - Frequently Asked Questions](https://clojure.org/guides/faq#seqs_vs_colls)


### Associative vs Sequencialã¨ã„ã†æ¦‚å¿µã®å¯¾ç«‹ {#524f01}

T.B.D.


## ğŸ”—References {#3b90d2}


### externals {#0bf849}

-   [Clojureã®sequenceé–¢ä¿‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã®ã¾ã¨ã‚ Â· GitHub](https://gist.github.com/syou6162/3648601)
