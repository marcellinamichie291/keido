+++
title = "📝仮想通貨bot戦略"
lastmod = 2022-09-08T14:13:01+09:00
draft = false
+++

-   up: [📝仮想通貨bot]({{< relref "20220603152137.md" >}})
-   refs
    -   [📝仮想通貨bot開発]({{< relref "20220717145220.md" >}})


## 🔖仮想通貨bot手法 {#73d718cb-a2fb-4add-8d46-41485ffc4db1}

-   頻度
    -   [📝高頻度bot]({{< relref "20220716131618.md" >}}): 取引を頻繁に繰り返すbot, HFT.
    -   [📝スイングbot]({{< relref "20220716132537.md" >}}): 数日から数週間程度の長さでポジションを持つbot.
-   トレード戦略
    -   [📝MMbot]({{< relref "20220716164647.md" >}}): マーケットメイクをつかっているbot.
    -   [📝アビトラbot]({{< relref "20220715213041.md" >}}): アービトラージをつかっているbot.
    -   [📝ブレイクアウト系bot]({{< relref "20220717083642.md" >}}) : テクニカル指標を元にトレンドを予測するbot.
        -   [📝ドテン君bot]({{< relref "20220717083642.md#2648e63b-05b4-4076-b942-15a1981a9c29" >}}): チャネルブレイクアウト戦略をつかっているbot.
    -   [📝イナゴbot]({{< relref "20220731094500.md" >}}): 急変イベントをトリガーに順張りするbot.
    -   [📝ヒゲ取りbot]({{< relref "20220731091702.md" >}}): ミスプライスによる瞬間的な価格変動を刈るbot.
    -   [📝MLbot]({{< relref "20220715210702.md" >}}): 機械学習をつかっているbot.
    -   [📝RLBot]({{< relref "20220716200424.md" >}}): 強化学習をつかっているbot.
-   その他
    -   [📝MTbot]({{< relref "20220722161007.md" >}}): 指値ではなく成功注文を行うbot.
    -   [📝SFDbot]({{< relref "20220823154327.md" >}}): bitFlyerのSFD手数料をとるbot.
-   マーケット
    -   CEX Bot: CEXを相手にするbot.
    -   [📝Dex Bot]({{< relref "20220716203300.md" >}}): DEXを相手にするbot.


## 📍スリッページ対策 {#862196}

[スリッページ]({{< relref "20220716193437.md#85eab48f-f42a-404d-88f4-cd91f397fa94" >}})の課題を技術的に克服するノウハウ, 主にネットワーク遅延やサーバ負荷のハンドリングノウハウ.

このイシューに関してはとくにネットワーク遅延やサーバ負荷によるbitFlyerサーバに関わる情報がとてもおおい.

[✅bitFlyer遅延問題と対策]({{< relref "20220719113407.md#bc089255-9ec0-4759-bc79-170ac385e520" >}})


### 板情報を自炊してローカルメモリ同期 {#4ded0a}

websocketから流れてくるtickからWeb画面で見られるような板情報を自作する. そうすると売り買いのマッチングである約定判断やポジション管理もできるようになる.

これができるようになると情報取得コストを削減できるし, たまに発生する通信遅延や失敗を回避できる.

-   [【BFS-X】ポジションを自炊して高速に売買を行うbitFlyerでの高速botフレームワーク(mmbotと高速スキャルピングbotのサンプルロジック付属)｜くもすけ｜note](https://note.com/kunmosky1/n/n112b73eee4f0)
-   <https://twitter.com/bufujini/status/1546360989142380545>
-   <https://twitter.com/bufujini/status/1549994324225855488>


### 板情報キャッシュにSortedDictをつかう {#661d54}

-   [BTC取引所毎の板情報取得 (python3): bitFlyer, BitMEX, Binance - Qiita](https://qiita.com/penta2019/items/d64245d809a7ac0fbcf5)
-   [Coincheck用板情報取得クラス（so比較ket_io、websocket）python｜はぐ｜note](https://note.com/tibita78/n/n2ac028b87d84)
-   <https://mobile.twitter.com/Ros_1224/status/1102904606403657728>

> SortedDictは追加した要素が自動的にkeyの値で昇順にソートされるシーケンス型です。要素の追加・削除は計算量O(log(n))であるため、O(1)の組み込みのdictに比べると若干遅いですが、板情報を現在価格から近い順に参照したい場合、追加のsort(通常計算量がO(n log(n))以上)が必要ないため、結果的に高速に動作します。

賛否両論ある.

> ;; <https://mobile.twitter.com/arms22/status/1354972612875542531>
>
> sorteddict なんていらんかったんや。使う直前にsort一回すればええんやで。
>
> 板情報の更新にsorteddictつかったんだけど更新のたびにソートが走るので僕の用途にはあわないなぁと思った次第。


### 約定履歴検索に二分探索をつかう {#8ebee3}

idが時系列の数字であることに注目.

[[二分探索]少ないAPIリクエストで効率的にbitFlyer約定履歴を検索する｜Nagi｜note](https://note.com/nagi7692/n/ne8cbeb6d12fa)


### 💡ポジションずれ問題 {#b5af4b}

取引所からポジションのデータがエラーで取得できなかったりといった理由で遅延して送られてくること.

-   [botter記(22-03-30) ポジションずれ問題考察｜黒枝｜note](https://note.com/kuroeda11/n/n812a8943e11d)


## 📍損切り戦略 {#d2bf21}

稼ぐためのビッグイシューは損切. 仕込みでもなく手仕舞いでもない. botで如何にして損失を防ぐかが稼ぐかにつながるのは一般的に言えること.

２つのサブイシューに分解できる.

-   損切り執行をうまくやる.
-   そもそも損切りが発生しないようにする.

うまく損切りを執行するよりそもそも損切りが発生しないようにしたほうが稼げるとか. なぜならばバックテストで上手く損切りできても実際のトレードでは上手く行かないことがおおい.

ref. [3年間、仮想通貨自動売買BOTを作って思うこと。｜愚者の戦略｜note](https://note.com/memoran_yukiblog/n/nccb5a874005c)


### ✅最良価格指定による指値注文で成行のように注文する {#1fb3c88b-bca7-4748-b0a9-ede0e3192d78}

[価格優先の原則]({{< relref "20220716193437.md#fc6ecde3-992c-4c37-a919-7f8f2b2ebdaf" >}})というものがある. 板情報におけるマッチングアルゴリズム.

成行注文は反対方向のとマッチングされるため, 確実にマッチングさせるには指値の場合は反対側の[最良価格]({{< relref "20220716193437.md#4ea430bf-b0e3-47e3-85d7-51f6e2f888b7" >}})を指定する(もちろん市場は動くのでこれも確実ではない).

派生パターンとして, 買い指値の場合のbest bid/売り指値の場合のbest askを指定すると, これは板における先頭に自分の注文を並べる行為で, 最も優先してマッチングされる可能性がある.

または, [mid rate]({{< relref "20220716193437.md#d22e321c-5e72-4453-95da-a31a7d3b193d" >}})(best bid/askの平均)でもいい.


### 💡ストップリミットによる損切 {#bc9ca5}

成行注文で損切りよりも指値注文で損切りするほうが損失が少ないものの, 市場急変でそもそも指値による損切りが失敗することがある.

この指値と成行の両方の個性を活かす弁証法的解決方法としての[ストップリミット注文]({{< relref "20220716193437.md#b46d5510-e230-4d6e-adea-270a6c4c6cd4" >}})のようなロジックがいいと思った.


### 💡ATRによる損切り {#57ee5c}

[ATR]({{< relref "20220714213106.md#b90e8a26-ea2a-4770-aad6-cf717075f9fb" >}})を損切りの指標にする.


### 💡トレーリングストップによる利確 {#82a2f0}

トレンドフォローにおける[トレーリングストップ]({{< relref "20220716193437.md#f647f4b3-2b1b-493a-9ecf-e8f444b9c5c6" >}})を実装する.

-   [BitflyerFXの自動売買BOTにトレイリングストップを実装してみよう！](https://ryota-trade.com/?p=3019)
-   [BTCFXでパラボリックSARを使って加速するトレイリングストップを作ろう！](https://ryota-trade.com/?p=3659)
-   [pybottersとasyncioでinago flyer!｜pe｜note](https://note.com/clever_dahlia308/n/n2841ee8a9043)


## 仮想通貨bot手法/戦略トピックス {#0f1b88}

手法各論ではなく, 手法同士の比較や一般論をまとめ.


### 📍戦略イシュー {#3d8371}

戦略の抽象化.

ref. [脱初心者。BOTで利益を上げるための読み物｜kapipara｜note](https://note.com/kapipara180/n/n94d162561a64)

-   セットアップ
-   売買シグナル
-   プロテクティブストップ
-   ポジションサイジング
-   手仕舞い

参考になった. いろいろな人がそれぞれの用語でこれらのイシューのどれかもしくは組み合わせをかたっている. 多かれ少なかれこの5ステップで分解して取り組むことになるのでは?


### <span class="org-todo todo _">📊</span> 高頻度(HFT)botとスイングbot比較 {#0c77005e-c63f-4b4b-b9de-e33a63c4ccf1}

-   取引頻度
    -   HFTは多い. 手数料はスイングよりかさむ.
    -   スイングは少ない.
-   利確の回数
    -   HFTは多い. スイングは少ない. これは取引頻度の差.
-   1回の利益
    -   HFTは小さな利益を積み重ねる.
    -   スイングは大きいトレンドを狙い大きな利益を取りに行く.
-   開発難易度
    -   スイングはHFTに比べて取引回数が少ないという点では容易.


### 💡予測より執行 {#07c68b84-1878-4dd6-88d4-5b004315004d}

予測と執行どっちが大事か, という議論.

-   [取引戦略作成入門（仮説立案編） | 考えるハリネズミ](https://www.column.erizo.co.jp/data_analysis/kaseturitsuanhen/)
-   [「予測より執行」について](https://bittokoinn.tokyo/posts/prediction_and_execution/)
-   [予測力と執行戦略について｜Hoheto (仮想通貨botter)｜note](https://note.com/hht/n/nb7fcfe538c59)

> ;; <https://twitter.com/Ros_1224/status/1310462781661917184?s=20>
>
> 何が難しいって執行戦略＞＞予測力　はそうなんですがそれ以前に執行する対象がないんですよねようは約定がないんですｗｗｗ　対象銘柄の選定方法を見直すべきか？

<!--quoteend-->

> ;; <https://twitter.com/i_love_profit/status/1309272693594681346?s=20>
>
> ボット自体の収益力において重要なのは、戦場選び & 執行戦略 >>> 予測力　だと思っているので、本来リソースをかけるべきなのはMLではなく様々な市場へのアプローチや多様な執行戦略のトライ＆エラーでは？とか思ってしまうわけです。

ref. [📚イシューからはじめよ - 安宅和人]({{< relref "20220604064044.md" >}})


## <span class="org-todo todo _">🔗</span> References {#d95867}

-   [年間、仮想通貨自動売買BOTを作って思うこと。｜愚者の戦略｜note](https://note.com/memoran_yukiblog/n/nccb5a874005c)
-   [脱初心者。BOTで利益を上げるための読み物｜kapipara｜note](https://note.com/kapipara180/n/n94d162561a64)
    -   いろいろと知らない用語があるのであとで調べたい.
